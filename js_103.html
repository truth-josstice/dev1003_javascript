<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pokemon Encounter</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      button {
        background-color: #f7c633;
        color: #3a5b91;
        border: 0;
        border-radius: 30px;
        cursor: pointer;
        font-size: 25px;
        font-weight: 600;
        outline: 0;
        padding: 16px 21px;
        margin-bottom: 20px;

        &:hover {
          transform: scale(1.05);
        }
      }
      .pokemonType {
        color: #3a5b91;
        font-size: 1.2em;
      }
      #pokemon-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin: 20px;
      }
      .pokemon-card {
        border: 2px solid #ccc;
        border-radius: 10px;
        padding: 15px;
        text-align: center;
        background: white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      }
      .pokemon-card img {
        max-width: 100px;
        height: auto;
      }
      .types {
        display: flex;
        justify-content: center;
        gap: 5px;
        flex-wrap: wrap;
      }
      .pokemonType {
        background: #f0f0f0;
        padding: 3px 8px;
        border-radius: 15px;
        font-size: 12px;
        margin: 2px;
      }
    </style>
  </head>
  <body>
    <button id="create-encounter">Encounter a Pokemon!</button>
    <article class="card">
      <img src="default_pokeapi.png" alt="Pokemon logo" />
<!-- 
      <section>
        <h2 class="pokemonName"></h2>
        <div class="types">
          for each type, dynamically create a paragraph -->
          <!-- <p class="pokemonType"></p> -->
        <!--</div> -->
      <!-- </section> -->
      <div id="pokemon-container"></div>
    </article>

    <script>
      function getRandomNumberForPokeAPI() {
        // The "1025" is just a safe maximum for how many Pokemon are currently in the API.
        // When they add more Pokemon, that number should go up.
        let suitableNumber = Math.floor(Math.random() * 1025);
        return suitableNumber;
      }

        function showPokemonData(data) {
            console.log(data);
            const { name, types, sprites } = data;

            // Create the main card container
            const card = document.createElement('div');
            card.className = 'pokemon-card';

            // Create and populate the name element
            const nameElement = document.createElement('h2');
            nameElement.className = 'pokemonName';
            nameElement.innerText = name;

            // Create and populate the image element
            const imageElement = document.createElement('img');
            let sprite = sprites.front_default ?? 
                        sprites.versions["generation-viii"]?.icons?.front_default ??
                        'fallback-image-url.png'; // fallback if no sprite found
            imageElement.src = sprite;
            imageElement.alt = `The image sprite for ${name}`;

            // Create and populate the types container
            const typesDiv = document.createElement('div');
            typesDiv.className = 'types';
            
            types.forEach((type) => {
                const newPara = document.createElement('p');
                newPara.innerText = type.type.name;
                newPara.classList.add('pokemonType');
                typesDiv.appendChild(newPara);
            });

            // Assemble the card
            card.appendChild(nameElement);
            card.appendChild(imageElement);
            card.appendChild(typesDiv);

            // Add the card to the container
            const container = document.getElementById('pokemon-container');
            container.appendChild(card);
        };

      function getPokemonData() {
        // 1. update with the correct url for POKEAPI:
        const POKEAPI = "https://pokeapi.co/api/v2/pokemon/";
        const randomPokemon = getRandomNumberForPokeAPI();
        // 2. use fetch to call the API
        fetch(POKEAPI + (randomPokemon))
          .then((response) => response.json())
          .then((data) => showPokemonData(data))
        // and call showPokemonData with the data returned from the fetch
      }

      // 4. Add the event listener to the button, so that clicking the button
      //    triggers a call to getPokemonData to display a new Pokemon
        let button = document.getElementById("create-encounter");
        button.addEventListener("click", function() {
            // Clear previous Pokémon
            const container = document.getElementById('pokemon-container');
            container.innerHTML = '';
            
            // Get 6 new Pokémon
            for (let i = 0; i < 6; i++) {
                getPokemonData();
            }
        });
      
      
    </script>
  </body>
</html>
